<%= turbo_frame_tag "line_item_material_breakdown_#{line_item_material_breakdown.id}" do %>
  <div class="card bg-base-100 shadow-md mb-4">
    <!-- Header -->
    <div class="card-body pb-3">
      <div class="flex items-center justify-between">
        <div>
          <h3 class="card-title text-lg font-bold">Material Breakdown</h3>
          <span class="badge badge-primary">Light Structural Steel - Up to 25 kg/m</span>
        </div>
      </div>
    </div>

    <!-- Material Rows Table Header -->
    <div class="px-6 pb-2 border-t">
      <div class="grid grid-cols-12 gap-3 text-xs font-semibold text-gray-600 uppercase tracking-wide">
        <div class="col-span-3">Material Supply</div>
        <div class="col-span-2">Thickness</div>
        <div class="col-span-2">Rate</div>
        <div class="col-span-2">Quantity</div>
        <div class="col-span-2 text-right">Line Total</div>
        <div class="col-span-1"></div>
      </div>
    </div>

    <!-- Material Rows -->
    <div class="border-t">
      <% if line_item_material_breakdown.line_item_materials.any? %>
        <% line_item_material_breakdown.line_item_materials.each do |material| %>
          <%= render 'line_item_materials/show', line_item_material: material %>
        <% end %>
      <% else %>
        <div class="px-6 py-4 text-center text-gray-500 text-sm">
          No materials added yet.
        </div>
      <% end %>
    </div>

    <!-- Add Material Button -->
    <div class="px-6 py-3 border-t bg-gray-50">
      <%= link_to "ï¼‹ Add Material", 
          line_item_material_breakdowns_path(line_item_material_breakdown_id: line_item_material_breakdown.id), 
          method: :post,
          remote: true,
          class: "btn btn-sm btn-outline" %>
    </div>

    <!-- Totals Section -->
    <div class="px-6 py-4 bg-gray-50 border-t space-y-2">
      <div class="flex justify-between text-sm">
        <span class="font-semibold text-gray-700">SUBTOTAL:</span>
        <span class="font-semibold text-gray-900">R<%= number_with_precision(line_item_material_breakdown.subtotal, precision: 2) %></span>
      </div>

      <div class="flex justify-between text-sm">
        <span class="font-semibold text-gray-700">MARGIN %:</span>
        <input type="number" placeholder="0%" step="0.1" class="input input-bordered input-xs w-24 text-right" />
      </div>

      <div class="flex justify-between text-lg font-bold border-t pt-2">
        <span class="text-gray-900">TOTAL:</span>
        <span class="text-blue-600">R<%= number_with_precision(line_item_material_breakdown.total, precision: 2) %></span>
      </div>
    </div>
  </div>
<% end %>
